"0","data_model_fat$inf_weight_poly <- I((data_model_fat$inf_weight_kg/10)^3)"
"0","data_model_fat$inf_weight_poly2 <- I((data_model_fat$inf_weight_kg/10)^3*log((data_model_fat$inf_weight_kg/10))) "
"0","data_model_fat$inf_length_poly <- I((data_model_fat$inf_length_cm/100)^2)"
"0","data_model_fat$inf_length_poly2 <- I((data_model_fat$inf_length_cm/100)^2* log((data_model_fat$inf_length_cm/100)))"
"0","data_model_fat$age_in_days_poly <- I((data_model_fat$age_in_days/100)^2)"
"0","data_model_fat$age_in_days_poly2 <- I((data_model_fat$age_in_days/100)^3)"
"0",""
"0","set.seed(123)"
"0","mod <- ols(fat_mass ~ inf_weight_poly + inf_weight_poly2 + inf_length_poly + inf_length_poly2 + age_in_days_poly + age_in_days_poly2 + baby_gender, data = data_model_fat, x=TRUE, y=TRUE)"
"0",""
"0","v <- validate(mod, B=1000, bw=TRUE, rule=""p"", sls=.1, type=""individual"")"
"1","
		Backwards Step-down - Original Model
"
"1","
"
"1",""
"1"," Deleted        "
"1"," Chi-Sq"
"1"," d.f."
"1"," P     "
"1"," Residual"
"1"," d.f."
"1"," P     "
"1"," AIC  "
"1"," R2   "
"1","
"
"1"," inf_length_poly"
"1"," 0.73  "
"1"," 1   "
"1"," 0.3932"
"1"," 0.73    "
"1"," 1   "
"1"," 0.3932"
"1"," -1.27"
"1"," 0.956"
"1","
"
"1","
Approximate Estimates after Deleting Factors

"
"1","                 "
"1","      Coef"
"1","     S.E."
"1","  Wald Z"
"1","         P"
"1","
Intercept        "
"1","  -2.42913"
"1"," 0.489190"
"1","  -4.966"
"1"," 6.849e-07"
"1","
inf_weight_poly  "
"1","   3.96456"
"1"," 0.074239"
"1","  53.403"
"1"," 0.000e+00"
"1","
inf_weight_poly2 "
"1","  -6.34036"
"1"," 0.328958"
"1"," -19.274"
"1"," 0.000e+00"
"1","
inf_length_poly2 "
"1"," -15.18495"
"1"," 2.785262"
"1","  -5.452"
"1"," 4.984e-08"
"1","
age_in_days_poly "
"1","  -0.09413"
"1"," 0.011131"
"1","  -8.457"
"1"," 0.000e+00"
"1","
age_in_days_poly2"
"1","   0.01020"
"1"," 0.001408"
"1","   7.242"
"1"," 4.425e-13"
"1","
baby_gender      "
"1","  -0.16571"
"1"," 0.022949"
"1","  -7.221"
"1"," 5.161e-13"
"1","
"
"1","
Factors in Final Model

"
"1","[1]"
"1"," inf_weight_poly  "
"1"," inf_weight_poly2 "
"1"," inf_length_poly2 "
"1"," age_in_days_poly "
"1"," age_in_days_poly2"
"1"," baby_gender      "
"1","
"
"0","##Adjust for overfitting"
"0","coef=(mod$coefficients)"
"0","shrink_factor <- v[""Slope"",""index.corrected""]"
"0","shrink_factor"
"1","[1]"
"1"," 0.9966229"
"1","
"
"0","overfit_adjustment <- coef*shrink_factor"
"0","overfit_adjustment"
"1","        Intercept "
"1","  inf_weight_poly "
"1"," inf_weight_poly2 "
"1","  inf_length_poly "
"1"," inf_length_poly2 "
"1"," age_in_days_poly "
"1","age_in_days_poly2 "
"1","      baby_gender "
"1","
"
"1","     -2.184178709 "
"1","      4.042783311 "
"1","     -6.565816571 "
"1","     -0.394737808 "
"1","    -14.322753826 "
"1","     -0.090395663 "
"1","      0.009824718 "
"1","     -0.162045251 "
"1","
"
"0","confint(mod)"
"1","                 "
"1","         2.5 %"
"1","      97.5 %"
"1","
Intercept        "
"1","  -3.298790520"
"1"," -1.08436934"
"1","
inf_weight_poly  "
"1","   3.799206464"
"1","  4.31375860"
"1","
inf_weight_poly2 "
"1","  -7.450986866"
"1"," -5.72514362"
"1","
inf_length_poly  "
"1","  -1.308661948"
"1","  0.51651115"
"1","
inf_length_poly2 "
"1"," -20.163034104"
"1"," -8.57954060"
"1","
age_in_days_poly "
"1","  -0.113980041"
"1"," -0.06742391"
"1","
age_in_days_poly2"
"1","   0.006977954"
"1","  0.01273807"
"1","
baby_gender      "
"1","  -0.208312636"
"1"," -0.11687607"
"1","
"
"0","###Cook's distance"
"0","# cooksd <- cooks.distance(model1)"
"0","# "
"0","# plot(cooksd, pch=""."", cex=2, main=""Influential Obs by Cooks distance"")  # plot cook's distance"
"0","# abline(h = 4*mean(cooksd, na.rm=T), col=""red"")  # add cutoff line"
"0","# text(x=1:length(cooksd)+1, y=cooksd, labels=ifelse(cooksd>4*mean(cooksd, na.rm=T),names(cooksd),""""), col=""red"")  # add labels"
"0",""
"0","data_model_fat$fat_mass_predicted <- predict(mod, data_model_fat)"
"0",""
"0","fit <- lm(data_model_fat$fat_mass ~ data_model_fat$fat_mass_predicted)"
"0","summary(fit)"
"1","
Call:
"
"1",""
"1","lm(formula = data_model_fat$fat_mass ~ data_model_fat$fat_mass_predicted)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-0.54849 "
"1","-0.11711 "
"1","-0.00072 "
"1"," 0.11985 "
"1"," 0.82810 "
"1","
"
"1","
Coefficients:
"
"1","                                 "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)                      "
"1"," -1.577e-15"
"1","  2.548e-02"
"1","    0.00"
"1","        1"
"1","    "
"1","
data_model_fat$fat_mass_predicted"
"1","  1.000e+00"
"1","  1.193e-02"
"1","   83.84"
"1","   <2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.1985"
"1"," "
"1","on"
"1"," "
"1","323"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.9561"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.9559"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 7030"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","323"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","#slope 95%"
"0","confint(fit, 'data_model_fat$fat_mass_predicted', level=0.95)"
"1","                                 "
"1","    2.5 %"
"1","   97.5 %"
"1","
data_model_fat$fat_mass_predicted"
"1"," 0.976536"
"1"," 1.023464"
"1","
"
"0","#Interval 95%"
"0","coef=(summary(fit)$coefficients[,1])"
"0","st_err=(summary(fit)$coefficients[,2])*2"
"0","upper_conf_int = coef + st_err"
"0","lower_conf_int = coef - st_err"
"0","lower_conf_int"
"1","                      (Intercept) "
"1","data_model_fat$fat_mass_predicted "
"1","
"
"1","                      -0.05095607 "
"1","                       0.97614643 "
"1","
"
"0","upper_conf_int"
"1","                      (Intercept) "
"1","data_model_fat$fat_mass_predicted "
"1","
"
"1","                       0.05095607 "
"1","                       1.02385357 "
"1","
"
"0","psychometric::CI.Rsqlm(fit, level = 0.95) "
